<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover">
    <style>
        body { margin:0; background:#FFF5E1; font-family:sans-serif; overflow:hidden; height:100vh; display:flex; flex-direction:column; }
        
        /* 1. CAMERA CIRCLE */
        #top-zone { width: 100%; height: 45vh; display: flex; justify-content: center; align-items: center; position: relative; }
        #camera-circle {
            width: 250px; height: 250px;
            border-radius: 50%; border: 6px solid white;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden; background: #000; z-index: 10;
        }
        video { width: 100%; height: 100%; object-fit: cover; transform: scaleX(-1); }

        /* 2. LION ANIMATIONS */
        #lion-stage { position: absolute; top: 45vh; width: 100%; height: 0; overflow: visible; z-index: 50; }
        .lion-wrap {
            position: absolute; bottom: -150px; width: 140px; height: 140px;
            transition: bottom 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .lion-img { position: absolute; width: 100%; height: 100%; object-fit: contain; opacity: 0; }
        .lion-up { bottom: 40px !important; }
        .mouth-active .img-1 { animation: mouth 0.4s infinite; }
        .mouth-active .img-2 { animation: mouth 0.4s infinite reverse; }
        @keyframes mouth { 0%, 49% { opacity: 1; } 50%, 100% { opacity: 0; } }

        /* 3. BUBBLE ANIMATIONS */
        #bg-fx { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 5; }
        .bubble { position: absolute; border-radius: 50%; bottom: -50px; animation: rise linear forwards; opacity: 0.6; }
        @keyframes rise { 100% { transform: translateY(-110vh); } }

        /* 4. UI PANEL */
        .ui-panel { flex: 1; background: white; border-radius: 40px 40px 0 0; padding: 25px; z-index: 100; box-shadow: 0 -10px 30px rgba(0,0,0,0.05); text-align: center; }
        .btn { width: 100%; padding: 20px; margin-bottom: 12px; border: 3px solid #5D4037; border-radius: 20px; font-weight: bold; font-size: 20px; background: #FFF; box-shadow: 0 6px 0 #5D4037; }
        .correct { background: #B9FBC0 !important; }
        
        #game-area { display: none; }
    </style>
</head>
<body>

    <div id="bg-fx"></div>

    <div id="top-zone">
        <div id="camera-circle">
            <video id="v" autoplay playsinline webkit-playsinline muted></video>
        </div>
    </div>

    <div id="lion-stage"></div>

    <div class="ui-panel">
        <div id="start-screen">
            <h1 style="color:#5D4037">Lion Dance Game</h1>
            <button class="btn" onclick="start()">JOIN PARADE</button>
        </div>

        <div id="game-area">
            <h2 id="q-text">Is ƒê√† N·∫µng the city of bridges?</h2>
            <div id="options">
                <button class="btn" onclick="win(this)">YES! ü¶Å</button>
                <button class="btn" onclick="location.reload()">NO</button>
            </div>
        </div>
    </div>

<script>
    const colors = ["#FFB7B2", "#FFD700", "#FF4D4D", "#B2E2F2"];

    async function start() {
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('game-area').style.display = 'block';
        
        try {
            const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" } });
            const video = document.getElementById('v');
            video.srcObject = stream;
            video.play();
        } catch (e) {} // Removed system alert
    }

    function win(btn) {
        btn.classList.add('correct');
        document.getElementById('q-text').innerText = "Look at the Lions!";
        
        // Spawn Lions
        const stage = document.getElementById('lion-stage');
        for(let i=0; i<3; i++) {
            const w = document.createElement('div');
            w.className = 'lion-wrap mouth-active';
            w.style.left = `calc(${(100/4)*(i+1)}% - 70px)`;
            w.innerHTML = `<img src="lion-1.png" class="lion-img img-1" style="opacity:1"><img src="lion-2.png" class="lion-img img-2">`;
            stage.appendChild(w);
            setTimeout(() => w.classList.add('lion-up'), 100);
        }
    }

    function makeBubble() {
        const b = document.createElement('div');
        b.className = 'bubble';
        const s = Math.random() * 20 + 15;
        b.style.width = b.style.height = s + "px";
        b.style.left = Math.random() * 100 + "vw";
        b.style.background = colors[Math.floor(Math.random()*colors.length)];
        b.style.animationDuration = (Math.random()*3 + 2) + "s";
        document.getElementById('bg-fx').appendChild(b);
        setTimeout(() => b.remove(), 5000);
    }
    setInterval(makeBubble, 600);
</script>
</body>
</html>
